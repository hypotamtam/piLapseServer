<!DOCTYPE html>
<html style="height: 100%;" lang="en">
<head>
    <meta name="viewport" content="width=device-width, minimum-scale=0.1">
    <title>Pi lapse debug page</title>
</head>
<body style="margin: 0; background: #0e0e0e; height: 100%" onload="onLoad()">
<p id="status" style="color: #f0f0f0;"></p>
<img id="streamImg" style="-webkit-user-select: none;margin: auto;background-color: hsl(0, 0%, 25%);"
     alt="Video stream" src="">
<button onclick="stopStream()">stop</button>
<button onclick="status()">status</button>
</body>
</html>

<script>

    function onLoad() {
        document.getElementById("streamImg").src = window.location.origin + "/stream.mjpg"
        setTimeout(status, 2000)
    }

    function updateStatus(url) {
        const xmlHttp = new XMLHttpRequest();
        xmlHttp.onreadystatechange = function () {
            if (xmlHttp.readyState === xmlHttp.DONE && xmlHttp.status === 200) {
                document.getElementById("status").innerHTML = xmlHttp.responseText
            }
        }
        xmlHttp.open("GET", url, true);
        xmlHttp.send(null);
    }

    function stopStream() {
        updateStatus(window.location.origin + "/stop");
    }

    function status() {
        updateStatus(window.location.origin + "/healthCheck")
    }
</script>
